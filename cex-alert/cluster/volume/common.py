import logging
from logging.handlers import RotatingFileHandler

import uuid
import json

import requests


symbols_list = ['%5B%22BTCUSDT%22,%22ETHUSDT%22,%22BNBUSDT%22,%22NEOUSDT%22,%22LTCUSDT%22,%22QTUMUSDT%22,%22ADAUSDT%22,%22XRPUSDT%22,%22EOSUSDT%22,%22TUSDUSDT%22,%22IOTAUSDT%22,%22XLMUSDT%22,%22ONTUSDT%22,%22TRXUSDT%22,%22ETCUSDT%22,%22ICXUSDT%22,%22NULSUSDT%22,%22VETUSDT%22,%22LINKUSDT%22,%22ONGUSDT%22,%22HOTUSDT%22,%22ZILUSDT%22,%22ZRXUSDT%22,%22FETUSDT%22,%22BATUSDT%22,%22ZECUSDT%22,%22IOSTUSDT%22,%22CELRUSDT%22,%22DASHUSDT%22,%22THETAUSDT%22,%22ENJUSDT%22,%22ATOMUSDT%22,%22TFUELUSDT%22,%22ONEUSDT%22,%22FTMUSDT%22,%22ALGOUSDT%22,%22DOGEUSDT%22,%22DUSKUSDT%22,%22ANKRUSDT%22,%22WINUSDT%22,%22COSUSDT%22,%22MTLUSDT%22,%22DENTUSDT%22,%22KEYUSDT%22,%22WANUSDT%22,%22FUNUSDT%22,%22CVCUSDT%22,%22CHZUSDT%22,%22BANDUSDT%22,%22XTZUSDT%22,%22RENUSDT%22,%22RVNUSDT%22,%22HBARUSDT%22,%22NKNUSDT%22,%22STXUSDT%22,%22KAVAUSDT%22,%22ARPAUSDT%22,%22IOTXUSDT%22,%22RLCUSDT%22,%22CTXCUSDT%22,%22BCHUSDT%22,%22TROYUSDT%22,%22VITEUSDT%22,%22FTTUSDT%22,%22EURUSDT%22,%22OGNUSDT%22,%22WRXUSDT%22,%22LSKUSDT%22,%22BNTUSDT%22,%22LTOUSDT%22,%22MBLUSDT%22,%22COTIUSDT%22,%22STPTUSDT%22,%22DATAUSDT%22,%22SOLUSDT%22,%22CTSIUSDT%22,%22HIVEUSDT%22,%22CHRUSDT%22%5D', '%5B%22ARDRUSDT%22,%22MDTUSDT%22,%22STMXUSDT%22,%22KNCUSDT%22,%22LRCUSDT%22,%22COMPUSDT%22,%22SCUSDT%22,%22ZENUSDT%22,%22SNXUSDT%22,%22VTHOUSDT%22,%22DGBUSDT%22,%22SXPUSDT%22,%22MKRUSDT%22,%22DCRUSDT%22,%22STORJUSDT%22,%22MANAUSDT%22,%22YFIUSDT%22,%22BALUSDT%22,%22BLZUSDT%22,%22IRISUSDT%22,%22KMDUSDT%22,%22JSTUSDT%22,%22CRVUSDT%22,%22SANDUSDT%22,%22NMRUSDT%22,%22DOTUSDT%22,%22LUNAUSDT%22,%22RSRUSDT%22,%22PAXGUSDT%22,%22TRBUSDT%22,%22SUSHIUSDT%22,%22KSMUSDT%22,%22EGLDUSDT%22,%22DIAUSDT%22,%22RUNEUSDT%22,%22FIOUSDT%22,%22UMAUSDT%22,%22BELUSDT%22,%22WINGUSDT%22,%22UNIUSDT%22,%22OXTUSDT%22,%22SUNUSDT%22,%22AVAXUSDT%22,%22FLMUSDT%22,%22UTKUSDT%22,%22XVSUSDT%22,%22ALPHAUSDT%22,%22AAVEUSDT%22,%22NEARUSDT%22,%22FILUSDT%22,%22INJUSDT%22,%22AUDIOUSDT%22,%22CTKUSDT%22,%22AKROUSDT%22,%22AXSUSDT%22,%22HARDUSDT%22,%22STRAXUSDT%22,%22ROSEUSDT%22,%22AVAUSDT%22,%22SKLUSDT%22,%22GRTUSDT%22,%22JUVUSDT%22,%22PSGUSDT%22,%221INCHUSDT%22,%22OGUSDT%22,%22ATMUSDT%22,%22ASRUSDT%22,%22CELOUSDT%22,%22RIFUSDT%22,%22TRUUSDT%22,%22CKBUSDT%22,%22TWTUSDT%22,%22FIROUSDT%22,%22LITUSDT%22,%22SFPUSDT%22,%22DODOUSDT%22,%22CAKEUSDT%22%5D','%5B%22ACMUSDT%22,%22BADGERUSDT%22,%22FISUSDT%22,%22OMUSDT%22,%22PONDUSDT%22,%22DEGOUSDT%22,%22ALICEUSDT%22,%22LINAUSDT%22,%22PERPUSDT%22,%22SUPERUSDT%22,%22CFXUSDT%22,%22TKOUSDT%22,%22PUNDIXUSDT%22,%22TLMUSDT%22,%22BARUSDT%22,%22FORTHUSDT%22,%22BAKEUSDT%22,%22BURGERUSDT%22,%22SLPUSDT%22,%22SHIBUSDT%22,%22ICPUSDT%22,%22ARUSDT%22,%22MASKUSDT%22,%22LPTUSDT%22,%22XVGUSDT%22,%22ATAUSDT%22,%22GTCUSDT%22,%22ERNUSDT%22,%22PHAUSDT%22,%22MLNUSDT%22,%22DEXEUSDT%22,%22C98USDT%22,%22CLVUSDT%22,%22QNTUSDT%22,%22FLOWUSDT%22,%22MINAUSDT%22,%22RAYUSDT%22,%22FARMUSDT%22,%22ALPACAUSDT%22,%22QUICKUSDT%22,%22MBOXUSDT%22,%22REQUSDT%22,%22GHSTUSDT%22,%22WAXPUSDT%22,%22GNOUSDT%22,%22XECUSDT%22,%22ELFUSDT%22,%22DYDXUSDT%22,%22IDEXUSDT%22,%22VIDTUSDT%22,%22USDPUSDT%22,%22GALAUSDT%22,%22ILVUSDT%22,%22YGGUSDT%22,%22SYSUSDT%22,%22DFUSDT%22,%22FIDAUSDT%22,%22AGLDUSDT%22,%22RADUSDT%22,%22BETAUSDT%22,%22RAREUSDT%22,%22LAZIOUSDT%22,%22CHESSUSDT%22,%22ADXUSDT%22,%22AUCTIONUSDT%22,%22DARUSDT%22,%22BNXUSDT%22,%22MOVRUSDT%22,%22CITYUSDT%22,%22ENSUSDT%22,%22QIUSDT%22,%22PORTOUSDT%22,%22POWRUSDT%22,%22JASMYUSDT%22,%22AMPUSDT%22,%22PYRUSDT%22,%22ALCXUSDT%22,%22SANTOSUSDT%22,%22BICOUSDT%22,%22FLUXUSDT%22%5D', '%5B%22FXSUSDT%22,%22VOXELUSDT%22,%22HIGHUSDT%22,%22CVXUSDT%22,%22PEOPLEUSDT%22,%22SPELLUSDT%22,%22JOEUSDT%22,%22ACHUSDT%22,%22IMXUSDT%22,%22GLMRUSDT%22,%22LOKAUSDT%22,%22SCRTUSDT%22,%22API3USDT%22,%22BTTCUSDT%22,%22ACAUSDT%22,%22XNOUSDT%22,%22WOOUSDT%22,%22ALPINEUSDT%22,%22TUSDT%22,%22ASTRUSDT%22,%22GMTUSDT%22,%22KDAUSDT%22,%22APEUSDT%22,%22BSWUSDT%22,%22BIFIUSDT%22,%22STEEMUSDT%22,%22NEXOUSDT%22,%22REIUSDT%22,%22LDOUSDT%22,%22OPUSDT%22,%22LEVERUSDT%22,%22STGUSDT%22,%22LUNCUSDT%22,%22GMXUSDT%22,%22POLYXUSDT%22,%22APTUSDT%22,%22OSMOUSDT%22,%22HFTUSDT%22,%22PHBUSDT%22,%22HOOKUSDT%22,%22MAGICUSDT%22,%22HIFIUSDT%22,%22RPLUSDT%22,%22PROSUSDT%22,%22GNSUSDT%22,%22SYNUSDT%22,%22VIBUSDT%22,%22SSVUSDT%22,%22LQTYUSDT%22,%22AMBUSDT%22,%22USTCUSDT%22,%22GASUSDT%22,%22GLMUSDT%22,%22PROMUSDT%22,%22QKCUSDT%22,%22UFTUSDT%22,%22IDUSDT%22,%22ARBUSDT%22,%22OAXUSDT%22,%22RDNTUSDT%22,%22WBTCUSDT%22,%22EDUUSDT%22,%22SUIUSDT%22,%22AERGOUSDT%22,%22PEPEUSDT%22,%22FLOKIUSDT%22,%22ASTUSDT%22,%22SNTUSDT%22,%22COMBOUSDT%22,%22MAVUSDT%22,%22PENDLEUSDT%22,%22ARKMUSDT%22,%22WBETHUSDT%22,%22WLDUSDT%22,%22SEIUSDT%22%5D', '%5B%22CYBERUSDT%22,%22ARKUSDT%22,%22CREAMUSDT%22,%22IQUSDT%22,%22FDUSDTRY%22,%22NTRNUSDT%22,%22TIAUSDT%22,%22MEMEUSDT%22,%22ORDIUSDT%22,%22BEAMXUSDT%22,%22PIVXUSDT%22,%22VICUSDT%22,%22BLURUSDT%22,%22VANRYUSDT%22,%22AEURUSDT%22,%22JTOUSDT%22,%221000SATSUSDT%22,%22BONKUSDT%22,%22ACEUSDT%22,%22NFPUSDT%22,%22AIUSDT%22,%22XAIUSDT%22,%22MANTAUSDT%22,%22ALTUSDT%22,%22JUPUSDT%22,%22PYTHUSDT%22,%22RONINUSDT%22,%22DYMUSDT%22,%22PIXELUSDT%22,%22STRKUSDT%22,%22PORTALUSDT%22,%22PDAUSDT%22,%22AXLUSDT%22,%22WIFUSDT%22,%22METISUSDT%22,%22AEVOUSDT%22,%22BOMEUSDT%22,%22ETHFIUSDT%22,%22ENAUSDT%22,%22WUSDT%22,%22TNSRUSDT%22,%22SAGAUSDT%22,%22TAOUSDT%22,%22OMNIUSDT%22,%22REZUSDT%22,%22BBUSDT%22,%22NOTUSDT%22,%22IOUSDT%22,%22ZKUSDT%22,%22LISTAUSDT%22,%22ZROUSDT%22,%22GUSDT%22,%22BANANAUSDT%22,%22RENDERUSDT%22,%22TONUSDT%22,%22DOGSUSDT%22,%22EURIUSDT%22,%22SLFUSDT%22,%22POLUSDT%22,%22NEIROUSDT%22,%22TURBOUSDT%22,%221MBABYDOGEUSDT%22,%22CATIUSDT%22,%22HMSTRUSDT%22,%22EIGENUSDT%22,%22SCRUSDT%22,%22BNSOLUSDT%22,%22LUMIAUSDT%22,%22KAIAUSDT%22,%22COWUSDT%22,%22CETUSUSDT%22,%22PNUTUSDT%22,%22ACTUSDT%22,%22USUALUSDT%22,%22THEUSDT%22%5D']

RATIO = 2

BIAN_API = "https://api.binance.com/api/v3"
BIAN_FUTURE_API = "https://fapi.binance.com"

def configure_logger(file_name):
    """配置日志记录器"""
    logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
    logger = logging.getLogger()
    
    # 创建 RotatingFileHandler 实例，设置日志文件的最大大小和最大数量
    handler = RotatingFileHandler(file_name, maxBytes=10*1024*1024, backupCount=5)
    handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
    logger.addHandler(handler)
    return logger

def sned_alerts_to_dc(logger, content, channel_id):
    msg = {
        "content": content,
        "nonce": str(uuid.uuid4())[:25],
        "tts": False
    }
    url = f'https://discord.com/api/v9/channels/{channel_id}/messages'    

    headers = {
        "Authorization": authorizations["nevermore"],
        "Content-Type": "application/json",
        "User-Agent": ""
    }

    logger.info(f"channel: {channel_id}")
    try:
        res = requests.post(url=url, headers=headers, data=json.dumps(msg))
        res.raise_for_status()  
    except requests.RequestException as e:
        logger.error(e)     